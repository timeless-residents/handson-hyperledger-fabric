# 1. Hyperledger Fabricの概要

## Hyperledger Fabricとは

Hyperledger Fabricは、Linux Foundationが主導するオープンソースのエンタープライズ向けブロックチェーンプラットフォームです。パーミッションド（許可型）のブロックチェーンとして設計されており、企業や組織間での安全なデータ共有と取引を可能にします。

Bitcoin や Ethereum などのパブリックブロックチェーンとは異なり、Hyperledger Fabricは以下の特徴を持っています：

- **アクセス制御**: 事前に承認された参加者のみがネットワークに参加可能
- **高性能**: パブリックブロックチェーンより高いトランザクション処理速度
- **機密性**: トランザクションデータをプライベートに保持可能
- **プラグイン可能なコンセンサスメカニズム**: 用途に応じて選択可能
- **スマートコントラクト多言語サポート**: Go、Java、JavaScript/TypeScriptで開発可能

## アーキテクチャ概要

Hyperledger Fabricは「execute-order-validate」と呼ばれるユニークなアーキテクチャを採用しています：

1. **実行（Execute）**: トランザクションはエンドーサーノードで実行され、結果（read-write set）が生成されます
2. **順序付け（Order）**: 認証済みのトランザクションは順序付けサービスによって順序付けされます
3. **検証（Validate）**: コミッターノードがトランザクションを検証し、台帳に追加します

![Hyperledger Fabricのアーキテクチャ](./images/fabric-architecture.png)

## 主要コンポーネント

### ピア（Peer）

ピアは、ブロックチェーンネットワークのコアコンポーネントです。以下の役割を担います：

- **台帳の保持**: ブロックチェーンデータを保存
- **チェーンコードの実行**: スマートコントラクトを実行
- **トランザクションの検証**: トランザクションを検証し承認

ピアには以下のタイプがあります：
- **エンドーサーピア（Endorsing Peer）**: トランザクション提案を実行・承認するピア
- **コミッターピア（Committing Peer）**: 台帳にトランザクションを追加するピア（すべてのピアがコミッターとしての役割を持ちます）
- **アンカーピア（Anchor Peer）**: 他の組織のピアと通信するために指定されたピア

### オーダリングサービス（Ordering Service）

オーダリングサービス（オーダラー）は、以下の重要な役割を果たします：

- **トランザクションの順序付け**: 承認済みトランザクションを時間順に並べる
- **ブロックの作成**: 順序付けられたトランザクションからブロックを作成
- **チャネルへのブロックの配信**: 作成したブロックをチャネルのすべてのピアに配信

Fabricでは、複数のコンセンサスプロトコルを選択できます：
- **Solo**: 単一ノードのオーダラー（開発・テスト用）
- **Kafka**: Apache Kafkaに基づくクラッシュ耐性のあるオーダリングサービス
- **Raft**: 「クラッシュフォールトトレラント（CFT）」なコンセンサスアルゴリズム（推奨）

### チャネル（Channel）

チャネルは、参加メンバー間でプライベートな通信と取引を可能にする分離された台帳です。主な特徴：

- **データの分離**: チャネルのデータは参加者のみがアクセス可能
- **複数の台帳**: 複数のチャネルを作成して異なるビジネス関係を表現可能
- **プライバシー**: 機密情報をネットワーク全体に公開せずに共有可能

### チェーンコード（Chaincode）

チェーンコードは、Hyperledger Fabricにおけるスマートコントラクトの実装です：

- **ビジネスロジック**: 台帳とのやり取りを定義するプログラム
- **複数言語サポート**: Go、Java、JavaScript/TypeScriptでの開発が可能
- **台帳へのアクセス**: 台帳データの読み書きを行う唯一の方法

### メンバーシップサービスプロバイダ（MSP）

MSPは、ネットワーク内のアクセス制御と認証を担当します：

- **ID管理**: X.509証明書に基づくアイデンティティの管理
- **アクセス制御**: ネットワークリソースへのアクセス権限の定義
- **組織の定義**: ネットワーク内の組織の境界を定義

### プライベートデータコレクション（Private Data Collection）

機密データを取引の相手方とのみ共有するための機能：

- **プライバシー**: 機密データをチャネル全体に公開せずに共有
- **ハッシュ証明**: データのハッシュのみがチャネルの台帳に記録
- **ピア間通信**: 実際のデータは承認されたピア間で直接共有

## Hyperledger Fabricのワークフロー

典型的なFabricトランザクションのワークフロー：

1. **クライアントがトランザクション提案を作成**: アプリケーションがチェーンコード機能の呼び出しを要求
2. **エンドーシングピアによる実行**: 指定されたピアがトランザクションを実行し、結果に署名
3. **オーダリングサービスへの送信**: 署名付き提案レスポンスがオーダラーに送信
4. **順序付けとブロック生成**: トランザクションが順序付けられ、ブロックが作成
5. **ピアへの配信**: ブロックがチャネルのすべてのピアに配信
6. **検証と台帳更新**: ピアがトランザクションを検証し、ローカルの台帳を更新
7. **イベント通知**: 台帳更新イベントがアプリケーションに通知

## Hyperledger Fabricの利点

Hyperledger Fabricは、エンタープライズブロックチェーンとして以下の利点を提供します：

- **パフォーマンス**: 高スループットと低レイテンシーのトランザクション処理
- **プライバシーとセキュリティ**: 機密データの保護と参加者のアクセス制御
- **柔軟性**: モジュラーアーキテクチャと複数言語サポート
- **スケーラビリティ**: チャネルによるデータ分割と水平スケーリング
- **決定性**: 予測可能なトランザクション結果
- **許可型**: 参加者の身元確認とアクセス制御

## 次のステップ

- [環境構築](2-setup.md) - 開発環境のセットアップ方法
- [ネットワーク構築](3-network.md) - テストネットワークの構築手順
- [チェーンコード開発](4-chaincode.md) - スマートコントラクトの開発方法